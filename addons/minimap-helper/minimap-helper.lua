addon.name    = 'minimap-helper'
addon.author  = 'lin'
addon.version = '1.0.0'
addon.desc    = 'Automates minimap scale changes'

local Packets = require('lin.packets')

local ZoneScale = {
    [  0] = 0.5, -- UNKNOWN
    [  1] = 0.5, -- PHANAUET_CHANNEL
    [  2] = 0.5, -- CARPENTERS_LANDING
    [  3] = 0.5, -- MANACLIPPER
    [  4] = 0.5, -- BIBIKI_BAY
    [  5] = 0.5, -- ULEGUERAND_RANGE
    [  6] = 0.5, -- BEARCLAW_PINNACLE
    [  7] = 0.5, -- ATTOHWA_CHASM
    [  8] = 0.5, -- BONEYARD_GULLY
    [  9] = 0.5, -- PSOXJA
    [ 10] = 0.5, -- THE_SHROUDED_MAW
    [ 11] = 0.5, -- OLDTON_MOVALPOLOS
    [ 12] = 0.5, -- NEWTON_MOVALPOLOS
    [ 13] = 0.5, -- MINE_SHAFT_2716
    [ 14] = 0.5, -- HALL_OF_TRANSFERENCE
    [ 15] = 0.5, -- ABYSSEA_KONSCHTAT
    [ 16] = 0.5, -- PROMYVION_HOLLA
    [ 17] = 0.5, -- SPIRE_OF_HOLLA
    [ 18] = 0.5, -- PROMYVION_DEM
    [ 19] = 0.5, -- SPIRE_OF_DEM
    [ 20] = 0.5, -- PROMYVION_MEA
    [ 21] = 0.5, -- SPIRE_OF_MEA
    [ 22] = 0.5, -- PROMYVION_VAHZL
    [ 23] = 0.5, -- SPIRE_OF_VAHZL
    [ 24] = 0.5, -- LUFAISE_MEADOWS
    [ 25] = 0.5, -- MISAREAUX_COAST
    [ 26] = 0.5, -- TAVNAZIAN_SAFEHOLD
    [ 27] = 0.5, -- PHOMIUNA_AQUEDUCTS
    [ 28] = 0.5, -- SACRARIUM
    [ 29] = 0.5, -- RIVERNE_SITE_B01
    [ 30] = 0.5, -- RIVERNE_SITE_A01
    [ 31] = 0.5, -- MONARCH_LINN
    [ 32] = 0.5, -- SEALIONS_DEN
    [ 33] = 0.5, -- ALTAIEU
    [ 34] = 0.5, -- GRAND_PALACE_OF_HUXZOI
    [ 35] = 0.5, -- THE_GARDEN_OF_RUHMET
    [ 36] = 0.5, -- EMPYREAL_PARADOX
    [ 37] = 0.5, -- TEMENOS
    [ 38] = 0.5, -- APOLLYON
    [ 39] = 0.5, -- DYNAMIS_VALKURM
    [ 40] = 0.5, -- DYNAMIS_BUBURIMU
    [ 41] = 0.5, -- DYNAMIS_QUFIM
    [ 42] = 0.5, -- DYNAMIS_TAVNAZIA
    [ 43] = 0.5, -- DIORAMA_ABDHALJS_GHELSBA
    [ 44] = 0.5, -- ABDHALJS_ISLE_PURGONORGO
    [ 45] = 0.5, -- ABYSSEA_TAHRONGI
    [ 46] = 0.5, -- OPEN_SEA_ROUTE_TO_AL_ZAHBI
    [ 47] = 0.5, -- OPEN_SEA_ROUTE_TO_MHAURA
    [ 48] = 0.5, -- AL_ZAHBI
    [ 50] = 0.5, -- AHT_URHGAN_WHITEGATE
    [ 51] = 0.5, -- WAJAOM_WOODLANDS
    [ 52] = 0.5, -- BHAFLAU_THICKETS
    [ 53] = 0.5, -- NASHMAU
    [ 54] = 0.5, -- ARRAPAGO_REEF
    [ 55] = 0.5, -- ILRUSI_ATOLL
    [ 56] = 0.5, -- PERIQIA
    [ 57] = 0.5, -- TALACCA_COVE
    [ 58] = 0.5, -- SILVER_SEA_ROUTE_TO_NASHMAU
    [ 59] = 0.5, -- SILVER_SEA_ROUTE_TO_AL_ZAHBI
    [ 60] = 0.5, -- THE_ASHU_TALIF
    [ 61] = 0.5, -- MOUNT_ZHAYOLM
    [ 62] = 0.5, -- HALVUNG
    [ 63] = 0.5, -- LEBROS_CAVERN
    [ 64] = 0.5, -- NAVUKGO_EXECUTION_CHAMBER
    [ 65] = 0.5, -- MAMOOK
    [ 66] = 0.5, -- MAMOOL_JA_TRAINING_GROUNDS
    [ 67] = 0.5, -- JADE_SEPULCHER
    [ 68] = 0.5, -- AYDEEWA_SUBTERRANE
    [ 69] = 0.5, -- LEUJAOAM_SANCTUM
    [ 70] = 0.5, -- CHOCOBO_CIRCUIT
    [ 71] = 0.5, -- THE_COLOSSEUM
    [ 72] = 0.5, -- ALZADAAL_UNDERSEA_RUINS
    [ 73] = 0.5, -- ZHAYOLM_REMNANTS
    [ 74] = 0.5, -- ARRAPAGO_REMNANTS
    [ 75] = 0.5, -- BHAFLAU_REMNANTS
    [ 76] = 0.5, -- SILVER_SEA_REMNANTS
    [ 77] = 0.5, -- NYZUL_ISLE
    [ 78] = 0.5, -- HAZHALM_TESTING_GROUNDS
    [ 79] = 0.5, -- CAEDARVA_MIRE
    [ 80] = 0.5, -- SOUTHERN_SAN_DORIA_S
    [ 81] = 0.5, -- EAST_RONFAURE_S
    [ 82] = 0.5, -- JUGNER_FOREST_S
    [ 83] = 0.5, -- VUNKERL_INLET_S
    [ 84] = 0.5, -- BATALLIA_DOWNS_S
    [ 85] = 0.5, -- LA_VAULE_S
    [ 86] = 0.5, -- EVERBLOOM_HOLLOW
    [ 87] = 0.5, -- BASTOK_MARKETS_S
    [ 88] = 0.5, -- NORTH_GUSTABERG_S
    [ 89] = 0.5, -- GRAUBERG_S
    [ 90] = 0.5, -- PASHHOW_MARSHLANDS_S
    [ 91] = 0.5, -- ROLANBERRY_FIELDS_S
    [ 92] = 0.5, -- BEADEAUX_S
    [ 93] = 0.5, -- RUHOTZ_SILVERMINES
    [ 94] = 0.5, -- WINDURST_WATERS_S
    [ 95] = 0.5, -- WEST_SARUTABARUTA_S
    [ 96] = 0.5, -- FORT_KARUGO_NARUGO_S
    [ 97] = 0.5, -- MERIPHATAUD_MOUNTAINS_S
    [ 98] = 0.5, -- SAUROMUGUE_CHAMPAIGN_S
    [ 99] = 0.5, -- CASTLE_OZTROJA_S
    [100] = 0.5, -- WEST_RONFAURE
    [101] = 0.5, -- EAST_RONFAURE
    [102] = 0.5, -- LA_THEINE_PLATEAU
    [103] = 0.5, -- VALKURM_DUNES
    [104] = 0.5, -- JUGNER_FOREST
    [105] = 0.5, -- BATALLIA_DOWNS
    [106] = 0.5, -- NORTH_GUSTABERG
    [107] = 0.5, -- SOUTH_GUSTABERG
    [108] = 0.5, -- KONSCHTAT_HIGHLANDS
    [109] = 0.5, -- PASHHOW_MARSHLANDS
    [110] = 0.5, -- ROLANBERRY_FIELDS
    [111] = 0.5, -- BEAUCEDINE_GLACIER
    [112] = 0.5, -- XARCABARD
    [113] = 0.5, -- CAPE_TERIGGAN
    [114] = 0.5, -- EASTERN_ALTEPA_DESERT
    [115] = 0.5, -- WEST_SARUTABARUTA
    [116] = 0.5, -- EAST_SARUTABARUTA
    [117] = 0.5, -- TAHRONGI_CANYON
    [118] = 0.5, -- BUBURIMU_PENINSULA
    [119] = 0.5, -- MERIPHATAUD_MOUNTAINS
    [120] = 0.5, -- SAUROMUGUE_CHAMPAIGN
    [121] = 0.5, -- THE_SANCTUARY_OF_ZITAH
    [122] = 0.5, -- ROMAEVE
    [123] = 0.5, -- YUHTUNGA_JUNGLE
    [124] = 0.5, -- YHOATOR_JUNGLE
    [125] = 0.5, -- WESTERN_ALTEPA_DESERT
    [126] = 0.5, -- QUFIM_ISLAND
    [127] = 0.5, -- BEHEMOTHS_DOMINION
    [128] = 0.5, -- VALLEY_OF_SORROWS
    [129] = 0.5, -- GHOYUS_REVERIE
    [130] = 0.5, -- RUAUN_GARDENS
    [131] = 0.5, -- MORDION_GAOL
    [132] = 0.5, -- ABYSSEA_LA_THEINE
    [133] = 0.5, -- OUTER_RAKAZNAR_U2
    [134] = 0.5, -- DYNAMIS_BEAUCEDINE
    [135] = 0.5, -- DYNAMIS_XARCABARD
    [136] = 0.5, -- BEAUCEDINE_GLACIER_S
    [137] = 0.5, -- XARCABARD_S
    [138] = 0.5, -- CASTLE_ZVAHL_BAILEYS_S
    [139] = 0.5, -- HORLAIS_PEAK
    [140] = 0.5, -- GHELSBA_OUTPOST
    [141] = 0.5, -- FORT_GHELSBA
    [142] = 0.5, -- YUGHOTT_GROTTO
    [143] = 0.5, -- PALBOROUGH_MINES
    [144] = 0.5, -- WAUGHROON_SHRINE
    [145] = 0.5, -- GIDDEUS
    [146] = 0.5, -- BALGAS_DAIS
    [147] = 0.5, -- BEADEAUX
    [148] = 0.5, -- QULUN_DOME
    [149] = 0.5, -- DAVOI
    [150] = 0.5, -- MONASTIC_CAVERN
    [151] = 0.5, -- CASTLE_OZTROJA
    [152] = 0.5, -- ALTAR_ROOM
    [153] = 0.5, -- THE_BOYAHDA_TREE
    [154] = 0.5, -- DRAGONS_AERY
    [155] = 0.5, -- CASTLE_ZVAHL_KEEP_S
    [156] = 0.5, -- THRONE_ROOM_S
    [157] = 0.5, -- MIDDLE_DELKFUTTS_TOWER
    [158] = 0.5, -- UPPER_DELKFUTTS_TOWER
    [159] = 0.5, -- TEMPLE_OF_UGGALEPIH
    [160] = 0.5, -- DEN_OF_RANCOR
    [161] = 0.5, -- CASTLE_ZVAHL_BAILEYS
    [162] = 0.5, -- CASTLE_ZVAHL_KEEP
    [163] = 0.5, -- SACRIFICIAL_CHAMBER
    [164] = 0.5, -- GARLAIGE_CITADEL_S
    [165] = 0.5, -- THRONE_ROOM
    [166] = 0.5, -- RANGUEMONT_PASS
    [167] = 0.5, -- BOSTAUNIEUX_OUBLIETTE
    [168] = 0.5, -- CHAMBER_OF_ORACLES
    [169] = 0.5, -- TORAIMARAI_CANAL
    [170] = 0.5, -- FULL_MOON_FOUNTAIN
    [171] = 0.5, -- CRAWLERS_NEST_S
    [172] = 0.5, -- ZERUHN_MINES
    [173] = 0.5, -- KORROLOKA_TUNNEL
    [174] = 0.5, -- KUFTAL_TUNNEL
    [175] = 0.5, -- THE_ELDIEME_NECROPOLIS_S
    [176] = 0.5, -- SEA_SERPENT_GROTTO
    [177] = 0.5, -- VELUGANNON_PALACE
    [178] = 0.5, -- THE_SHRINE_OF_RUAVITAU
    [179] = 0.5, -- STELLAR_FULCRUM
    [180] = 0.5, -- LALOFF_AMPHITHEATER
    [181] = 0.5, -- THE_CELESTIAL_NEXUS
    [182] = 0.5, -- WALK_OF_ECHOES
    [183] = 0.5, -- MAQUETTE_ABDHALJS_LEGION_A
    [184] = 0.5, -- LOWER_DELKFUTTS_TOWER
    [185] = 0.5, -- DYNAMIS_SAN_DORIA
    [186] = 0.5, -- DYNAMIS_BASTOK
    [187] = 0.5, -- DYNAMIS_WINDURST
    [188] = 0.5, -- DYNAMIS_JEUNO
    [190] = 0.5, -- KING_RANPERRES_TOMB
    [191] = 0.5, -- DANGRUF_WADI
    [192] = 0.5, -- INNER_HORUTOTO_RUINS
    [193] = 0.5, -- ORDELLES_CAVES
    [194] = 0.5, -- OUTER_HORUTOTO_RUINS
    [195] = 0.5, -- THE_ELDIEME_NECROPOLIS
    [196] = 0.5, -- GUSGEN_MINES
    [197] = 0.5, -- CRAWLERS_NEST
    [198] = 0.5, -- MAZE_OF_SHAKHRAMI
    [200] = 0.5, -- GARLAIGE_CITADEL
    [201] = 0.5, -- CLOISTER_OF_GALES
    [202] = 0.5, -- CLOISTER_OF_STORMS
    [203] = 0.5, -- CLOISTER_OF_FROST
    [204] = 0.5, -- FEIYIN
    [205] = 0.5, -- IFRITS_CAULDRON
    [206] = 0.5, -- QUBIA_ARENA
    [207] = 0.5, -- CLOISTER_OF_FLAMES
    [208] = 0.5, -- QUICKSAND_CAVES
    [209] = 0.5, -- CLOISTER_OF_TREMORS
    [210] = 0.5, -- GM_HOME
    [211] = 0.5, -- CLOISTER_OF_TIDES
    [212] = 0.5, -- GUSTAV_TUNNEL
    [213] = 0.5, -- LABYRINTH_OF_ONZOZO
    [215] = 0.5, -- ABYSSEA_ATTOHWA
    [216] = 0.5, -- ABYSSEA_MISAREAUX
    [217] = 0.5, -- ABYSSEA_VUNKERL
    [218] = 0.5, -- ABYSSEA_ALTEPA
    [219] = 0.5, -- RESIDENTIAL_AREA
    [220] = 0.5, -- SHIP_BOUND_FOR_SELBINA
    [221] = 0.5, -- SHIP_BOUND_FOR_MHAURA
    [222] = 0.5, -- PROVENANCE
    [223] = 0.5, -- SAN_DORIA_JEUNO_AIRSHIP
    [224] = 0.5, -- BASTOK_JEUNO_AIRSHIP
    [225] = 0.5, -- WINDURST_JEUNO_AIRSHIP
    [226] = 0.5, -- KAZHAM_JEUNO_AIRSHIP
    [227] = 0.5, -- SHIP_BOUND_FOR_SELBINA_PIRATES
    [228] = 0.5, -- SHIP_BOUND_FOR_MHAURA_PIRATES
    [229] = 0.5, -- THRONE_ROOM_V
    [230] = 0.5, -- SOUTHERN_SAN_DORIA
    [231] = 0.5, -- NORTHERN_SAN_DORIA
    [232] = 0.5, -- PORT_SAN_DORIA
    [233] = 0.5, -- CHATEAU_DORAGUILLE
    [234] = 0.5, -- BASTOK_MINES
    [235] = 0.5, -- BASTOK_MARKETS
    [236] = 0.5, -- PORT_BASTOK
    [237] = 0.75, -- METALWORKS
    [238] = 0.5, -- WINDURST_WATERS
    [239] = 0.5, -- WINDURST_WALLS
    [240] = 0.5, -- PORT_WINDURST
    [241] = 0.5, -- WINDURST_WOODS
    [242] = 0.5, -- HEAVENS_TOWER
    [243] = 0.5, -- RULUDE_GARDENS
    [244] = 0.5, -- UPPER_JEUNO
    [245] = 0.5, -- LOWER_JEUNO
    [246] = 0.5, -- PORT_JEUNO
    [247] = 0.5, -- RABAO
    [248] = 0.5, -- SELBINA
    [249] = 0.5, -- MHAURA
    [250] = 0.5, -- KAZHAM
    [251] = 0.5, -- HALL_OF_THE_GODS
    [252] = 0.5, -- NORG
    [253] = 0.5, -- ABYSSEA_ULEGUERAND
    [254] = 0.5, -- ABYSSEA_GRAUBERG
    [255] = 0.5, -- ABYSSEA_EMPYREAL_PARADOX
    [256] = 0.5, -- WESTERN_ADOULIN
    [257] = 0.5, -- EASTERN_ADOULIN
    [258] = 0.5, -- RALA_WATERWAYS
    [259] = 0.5, -- RALA_WATERWAYS_U
    [260] = 0.5, -- YAHSE_HUNTING_GROUNDS
    [261] = 0.5, -- CEIZAK_BATTLEGROUNDS
    [262] = 0.5, -- FORET_DE_HENNETIEL
    [263] = 0.5, -- YORCIA_WEALD
    [264] = 0.5, -- YORCIA_WEALD_U
    [265] = 0.5, -- MORIMAR_BASALT_FIELDS
    [266] = 0.5, -- MARJAMI_RAVINE
    [267] = 0.5, -- KAMIHR_DRIFTS
    [268] = 0.5, -- SIH_GATES
    [269] = 0.5, -- MOH_GATES
    [270] = 0.5, -- CIRDAS_CAVERNS
    [271] = 0.5, -- CIRDAS_CAVERNS_U
    [272] = 0.5, -- DHO_GATES
    [273] = 0.5, -- WOH_GATES
    [274] = 0.5, -- OUTER_RAKAZNAR
    [275] = 0.5, -- OUTER_RAKAZNAR_U1
    [276] = 0.5, -- RAKAZNAR_INNER_COURT
    [277] = 0.5, -- RAKAZNAR_TURRIS
    [279] = 0.5, -- WALK_OF_ECHOES_P2
    [280] = 0.5, -- MOG_GARDEN
    [281] = 0.5, -- LEAFALLIA
    [282] = 0.5, -- MOUNT_KAMIHR
    [283] = 0.5, -- SILVER_KNIFE
    [284] = 0.5, -- CELENNIA_MEMORIAL_LIBRARY
    [285] = 0.5, -- FERETORY
    [287] = 0.5, -- MAQUETTE_ABDHALJS_LEGION_B
    [288] = 0.5, -- ESCHA_ZITAH
    [289] = 0.5, -- ESCHA_RUAUN
    [290] = 0.5, -- DESUETIA_EMPYREAL_PARADOX
    [291] = 0.5, -- REISENJIMA
    [292] = 0.5, -- REISENJIMA_HENGE
    [293] = 0.5, -- REISENJIMA_SANCTORIUM
    [294] = 0.5, -- DYNAMIS_SAN_DORIA_D
    [295] = 0.5, -- DYNAMIS_BASTOK_D
    [296] = 0.5, -- DYNAMIS_WINDURST_D
    [297] = 0.5, -- DYNAMIS_JEUNO_D
    [298] = 0.5, -- WALK_OF_ECHOES_P1
}

ashita.events.register('packet_in', 'packet_in_cb', function(e)
    if e.id == 0x000A then
        local chat = AshitaCore:GetChatManager()
        local zone = Packets.parse_zonein(e.data).zone
        local scale = ZoneScale[zone]

        print(string.format('Setting scale for zone %d to %.1f', zone, scale))
        chat:QueueCommand(1, string.format('/minimap zoom %.1f', scale))
    elseif e.id == 0x000B then
        local chat = AshitaCore:GetChatManager()
        chat:QueueCommand(1, '/minimap zoom 1')
    end
end)
